/*Most spendful hour (for all stores)*/
SELECT HOUR(date_time) as h, max(Total_amount)
FROM(
SELECT h, sum(Total_amount)
FROM transaction_
GROUP BY h);

/*Most popular spot*/
SELECT store_id, alley, shelf
FROM offers as OF
WHERE OF.store_id = ""  AND OF.barcode = 
SELECT barcode FROM(
   /*This query returns barcode and amount
   of the most popular product in the store*/
   SELECT barcode, max(pieces_sold)
   FROM(
     SELECT barcode, sum(pieces) as pieces_sold
     FROM contain natural join transaction_
     WHERE store_id = OF.store_id
     GROUP BY barcode
   )
);
